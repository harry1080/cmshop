!function (t) {
    function e(c) {
        if (a[c])return a[c].exports;
        var r = a[c] = {i: c, l: !1, exports: {}};
        return t[c].call(r.exports, r, r.exports, e), r.l = !0, r.exports
    }

    var a = {};
    e.m = t, e.c = a, e.d = function (t, a, c) {
        e.o(t, a) || Object.defineProperty(t, a, {configurable: !1, enumerable: !0, get: c})
    }, e.n = function (t) {
        var a = t && t.__esModule ? function () {
            return t.default
        } : function () {
            return t
        };
        return e.d(a, "a", a), a
    }, e.o = function (t, e) {
        return Object.prototype.hasOwnProperty.call(t, e)
    }, e.p = "/dist/", e(e.s = 4)
}([function (t, e, a) {
    "use strict";
    Object.defineProperty(e, "__esModule", {value: !0});
    var c = a(1), r = function (t) {
            return t && t.__esModule ? t : {default: t}
        }(c), i = {
            prdType: {PRODUCT: "1", BUNDLER: "2", EXTEND: "6", ACCIDENT: "7", SALE: "20"},
            PrdItemType: {PRODUCT: "S0", BUNDLER: "B", EXTEND: "S1", ACCIDENT: "S6", SALE: "20"},
            commonVariable: {SALEPORTAL: 2, SALECHANNEL: 1001, NEEDRESULTSET: 0}
        },

        //常量定义
        n = {
            INDEX_CART: "/newcart/shoppingCart.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            MERGE_CART: "/newcart/cache2cart.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            //加入购物车
            // ADD_CART: "/newcart/add.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            ADD_CART: '/goods.php?act=addCart',
            DEL_CART: "/newcart/del.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            UPDATE_CART: "/newcart/update.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            RECMND_CART: "/newcart/shoppingCart/getRecmndProducts.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL,
            // CART_NUMBER: "/newcart/shoppingCart/number.json?salePortal=" + i.commonVariable.SALEPORTAL + "&saleChannel=" + i.commonVariable.SALECHANNEL

            CART_NUMBER: "/goods.php?act=getCartNum"
        }, d = {
            buildQueryData: function (t) {
                var e = [], a = [], c = [], r = [], n = [], d = [];
                return $.each(t, function (o, s) {
                    switch (s.productType) {
                        case i.prdType.PRODUCT:
                            e.push(s.skuId), a.push(s.productType), c.push(s.quantity), r.push(""), n.push(s.skuId + ":" + s.quantity);
                            break;
                        case i.prdType.BUNDLER:
                            e.push(s.bundleId), a.push(s.productType), c.push(s.quantity), r.push(""), d.push(s.bundleId + ":" + s.quantity);
                            break;
                        case i.prdType.EXTEND:
                        case i.prdType.ACCIDENT:
                            e.push(s.skuId), a.push(s.productType), c.push(s.quantity), r.push(s.mainSkuId), $.each(t, function (t, e) {
                                if (e.skuId == s.mainSkuId)return n.push(s.skuId + ":" + e.quantity), !1
                            })
                    }
                }), {
                    sbs: e.join(","),
                    types: a.join(","),
                    qtys: c.join(","),
                    ess: r.join(","),
                    skuIdAndQtys: n.join(","),
                    bundlerIdAndQtys: d.join(","),
                    t: (new Date).getTime()
                }
            }, buildCartQueryData: function (t) {
                if (t) {
                    var e = [];
                    return $.each(t, function (t, a) {
                        var c = new cartSys.cartItemObj;
                        switch (a.productType) {
                            case i.prdType.PRODUCT:
                                c.itemId = a.skuId, c.itemType = i.PrdItemType.PRODUCT, c.qty = a.quantity, c.gifts = a.giftList;
                                break;
                            case i.prdType.BUNDLER:
                                c.itemId = a.bundleId, c.itemType = i.PrdItemType.BUNDLER, c.qty = a.quantity;
                                break;
                            case i.prdType.EXTEND:
                                c.itemId = a.skuId, c.itemType = i.PrdItemType.EXTEND, c.mainItemid = a.mainSkuId, c.qty = a.quantity;
                                break;
                            case i.prdType.ACCIDENT:
                                c.itemId = a.skuId, c.itemType = i.PrdItemType.ACCIDENT, c.mainItemid = a.mainSkuId, c.qty = a.quantity;
                                break;
                            case i.prdType.SALE:
                                c.itemId = a.skuId, c.itemType = i.PrdItemType.SALE, c.mainItemid = a.mainSkuId, c.qty = 1
                        }
                        e.push(c)
                    }), this.convertToCart(e)
                }
                return {}
            }, buildAddCartQueryData: function (t, e) {
                if ("productDetail" === t) {
                    var a = [];
                    return $.each(e, function (t, e) {
                        var c = new cartSys.cartItemObj;
                        switch (e.productType) {
                            case i.prdType.PRODUCT:
                                c.itemId = e.skuId, c.itemType = i.PrdItemType.PRODUCT, c.qty = e.quantity, c.gifts = e.giftList;
                                break;
                            case i.prdType.BUNDLER:
                                c.itemId = e.bundleId, c.itemType = i.PrdItemType.BUNDLER, c.qty = e.quantity;
                                break;
                            case i.prdType.EXTEND:
                                c.itemId = e.skuId, c.itemType = i.PrdItemType.EXTEND, c.mainItemid = e.mainSkuId, c.qty = e.quantity;
                                break;
                            case i.prdType.ACCIDENT:
                                c.itemId = e.skuId, c.itemType = i.PrdItemType.ACCIDENT, c.mainItemid = e.mainSkuId, c.qty = e.quantity
                        }
                        a.push(c)
                    }), {cartjson: (0, r.default)(a)}
                }
                return {cartjson: (0, r.default)(e)}
            }, buildUpdateQueryData: function (t) {
                var e = [];
                return $.each(t, function (t, a) {
                    var c = new cartSys.cartItemObj;
                    switch (String(a.productType)) {
                        case i.prdType.PRODUCT:
                            c.itemId = a.skuId, c.itemType = i.PrdItemType.PRODUCT, 3 != a.operation && (c.qty = a.quantity), c.gifts = a.giftList, c.operation = a.operation;
                            break;
                        case i.prdType.BUNDLER:
                            c.itemId = a.bundleId, c.itemType = i.PrdItemType.BUNDLER, 3 != a.operation && (c.qty = a.quantity), c.operation = a.operation;
                            break;
                        case i.prdType.EXTEND:
                            c.itemId = a.skuId, c.itemType = i.PrdItemType.EXTEND, c.mainItemid = a.mainSkuId, c.qty = a.quantity, c.operation = a.operation;
                            break;
                        case i.prdType.ACCIDENT:
                            c.itemId = a.skuId, c.itemType = i.PrdItemType.ACCIDENT, c.mainItemid = a.mainSkuId, c.qty = a.quantity, c.operation = a.operation;
                            break;
                        case i.prdType.SALE:
                            c.itemId = a.skuId, c.itemType = i.PrdItemType.SALE, c.mainItemid = a.mainSkuId, c.qty = 0, c.operation = a.operation
                    }
                    e.push(c)
                }), this.convertToCart(e)
            }, buildDelQueryData: function (t) {
            }, getJSONP: function (t) {
                if (cartSys.isEmpty(t) || cartSys.isEmpty(t.url) || !cartSys.isFunction(t.callback))return !1;
                var e = cartDomain + t.url + "&_t=" + (new Date).getTime() + "&callback=?";
                console.log("url:----" + e);
                return $.ajax({
                    url: e, dataType: "JSONP", timeout: 1e4, data: t.data, error: function (t, e) {
                        "timeout" == e ? ecWap.alert("请求超时，请稍后再试！") : ecWap.alert("系统异常，请稍后再试test！")
                    }, success: function (e) {
                        t.callback(e)
                    }
                }), !0
            }, getJSONPHint: function (t) {
                console.log('getJSONPHint');
                if (cartSys.isEmpty(t) || cartSys.isEmpty(t.url) || !cartSys.isFunction(t.callback))return !1;
                var e = cartDomain + t.url + "&_t=" + (new Date).getTime() + "&callback=?";
                console.log('e:' + e);
                return $.ajax({
                    url: e, dataType: "JSONP", timeout: 1e4, data: t.data, error: function (t, e) {
                        console.log(e + '------failed');
                    }, success: function (e) {
                        console.log(e);
                        console.log('------success');

                        "0" == e.retcode && t.callback(e)
                    }
                }), !0
            }, convertToCart: function (t) {
                for (var e = [], a = [], c = [], r = [], i = [], n = [], d = 0; d < t.length; d++) {
                    var o = t[d];
                    if ("S0" == o.itemType) {
                        e.push(o.itemId), o.itemProp && o.itemProp.Internal_Purchase && "true" == o.itemProp.Internal_Purchase ? a.push(8) : a.push(1), c.push(o.qty), r.push("");
                        var s = [];
                        if (o.gifts && o.gifts.length > 0)for (var u = 0; u < o.gifts.length; u++)s.push(o.gifts[u].sbomCode);
                        i.push(s.join("-")), n.push(o.operation)
                    }
                    "S1" == o.itemType && (e.push(o.itemId), a.push(6), c.push(o.qty), r.push(o.mainItemid), i.push(""), n.push(o.operation)), "S6" == o.itemType && (e.push(o.itemId), a.push(7), c.push(o.qty), r.push(o.mainItemid), i.push(""), n.push(o.operation)), "B" == o.itemType && (e.push(o.itemId), o.itemProp && o.itemProp.Internal_Purchase && "true" == o.itemProp.Internal_Purchase ? a.push(9) : a.push(2), c.push(o.qty), r.push(""), i.push(""), n.push(o.operation)), "20" == o.itemType && (e.push(o.itemId), a.push(20), c.push(o.qty), r.push(o.mainItemid), i.push(""), n.push(o.operation))
                }
                var p = {};
                return p.sbs = e.join(","), p.types = a.join(","), p.qtys = c.join(","), p.ess = r.join(","), p.gfs = i.join(","), p.ops = n.join(","), p
            }
        };
    window.cartSys = {
        queryData: function (t) {
            return d.buildQueryData(t)
        }, index: function (t, e) {
            var a = {};
            a.url = n.INDEX_CART, a.data = d.buildCartQueryData(t), a.callback = function (t) {
                "0" == t.retcode && cartSys.isFunction(e) && e(t)
            }, d.getJSONP(a)
        }, add: function (t, e, a) {
            var c = {};

            console.log('add function');
            c.url = n.ADD_CART,
                c.data = d.buildAddCartQueryData(t, e),


                c.callback = function (t) {
                console.log(t);
                "0" == t.retcode ? (ecWap.toast("添加商品成功"),
                cartSys.isFunction(a) && a(t)) : "TV0004" == t.retcode ? ecWap.alert("您购物车添加商品数量已达上限，请先结算部分商品哦") : ecWap.alert("系统异常，请稍后再试！")
            }, d.getJSONP(c)
        }, update: function (t, e) {
            var a = {};
            a.url = n.UPDATE_CART, cartSys.isEmpty(t) ? ecWap.alert("请选择您要修改的商品") : (a.data = d.buildUpdateQueryData(t), a.callback = function (t) {
                cartSys.isFunction(e) && "0" == t.retcode ? e(t) : "TV0004" == t.retcode ? ecWap.alert("您购物车添加商品数量已达上限，请先结算部分商品哦") : ecWap.alert("系统异常，请稍后再试！")
            }, d.getJSONP(a))
        }, del: function (t, e) {
            var a = {};
            if (a.url = n.DEL_CART, cartSys.isEmpty(t))return void ecWap.toast("请选择至少一件商品");
            a.callback = function (t) {
                cartSys.isFunction(e) && e(t)
            }, a.data = {cartjson: (0, r.default)(t)}, d.getJSONP(a)
        }, refresh: function (t) {
            window.location.reload()
        }, merge: function (t) {
            var e = {};
            e.url = n.MERGE_CART, e.callback = function (e) {
                cartSys.isFunction(t) && t(e)
            }, d.getJSONPHint(e)
        }, getCarPrdNum: function (t) {
            console.log('getCarPrdNum----FUNCTION--获得购物车数量');
            var e = {};

            //获得购物车数量
            e.url = n.CART_NUMBER, e.callback = function (e) {
                cartSys.isFunction(t) && t(e.cartNumber)
            }, d.getJSONPHint(e)
        }, getCarPrdNumAndSetCart: function () {
            if (cartSys.isEmpty(Utils.cookie.get("cartId")) && cartSys.isEmpty(Utils.cookie.get("uid")))return !1;
            cartSys.isEmpty(Utils.cookie.get("cartId")) || cartSys.isEmpty(Utils.cookie.get("uid")) ? cartSys.getCarPrdNum(function (t) {
                t > 99 ? $("#cartNum").html("99+").parent("em").addClass("show") : t > 0 && t <= 99 ? $("#cartNum").html(t).parent("em").addClass("show") : $("#cartNum").parent("em").removeClass("show")
            }) : cartSys.merge(function () {
                cartSys.getCarPrdNum(function (t) {
                    t > 99 ? $("#cartNum").html("99+").parent("em").addClass("show") : t > 0 && t <= 99 ? $("#cartNum").html(t).parent("em").addClass("show") : $("#cartNum").parent("em").removeClass("show")
                })
            })
        }, cartItemObj: function (t) {
            var e = {itemId: "", itemType: "", qty: "", gifts: [], mainItemid: "", operation: ""};
            return t && (e = $.extend(!0, {}, e, t)), {
                itemId: e.itemId,
                itemType: e.itemType,
                qty: e.qty,
                gifts: e.gifts,
                mainItemid: e.mainItemid,
                itemProp: e.itemProp,
                operation: e.operation
            }
        }, formatPrice: function (t) {
            t += "";
            var e = t.indexOf(".");
            if (e > 0) {
                return "00" == t.substring(e) ? parseInt(t.substring(0, e), 10) : parseFloat(t).toFixed(2)
            }
            return parseInt(t, 10)
        }, isFunction: function (t) {
            return "[object Function]" === Object.prototype.toString.call(t)
        }, isEmpty: function (t) {
            return "undefined" == t || null == t || "" == t || 0 == t.length
        }
    }, e.default = cartSys
}, function (t, e, a) {
    t.exports = {default: a(2), __esModule: !0}
}, function (t, e, a) {
    var c = a(3), r = c.JSON || (c.JSON = {stringify: JSON.stringify});
    t.exports = function (t) {
        return r.stringify.apply(r, arguments)
    }
}, function (t, e) {
    var a = t.exports = {version: "2.5.1"};
    "number" == typeof __e && (__e = a)
}, function (t, e, a) {
    "use strict";
    var c = a(0), r = function (t) {
        return t && t.__esModule ? t : {default: t}
    }(c), i = {
        prdType: {PRODUCT: "1", BUNDLER: "2", EXTEND: "6", ACCIDENT: "7", SALE: "20"},
        PrdItemType: {PRODUCT: "S0", BUNDLER: "B", EXTEND: "S1", ACCIDENT: "S6", SALE: "20"}
    };
    window.cartObj = {
        BIValue: "",
        selectedExtData: {},
        selectedAccData: {},
        serviceDialog: null,
        isUpdateUI: !1,
        selectedServerSbomCode: "",
        selectedServerShowData: {},
        isQryRecommand: !1,
        editSelectedServerData: {},
        oldSelectedServerData: {},
        initTip: function () {
            for (var t = $(".disabledcss").length, e = 0; e < t; e++) {
                var a = $($(".disabledcss")[e]);
                a.find("span").html(cartObj.getInvalidCauseReasonDesc(a.attr("data-status"), a.attr("producttype"), a.attr("data-minlimit")))
            }
            0 == $("#product-list :checkbox[data-state=0][data-type!=20]").length ? ($("#product-list :checkbox").prop("checked", !1), $("#checkall").prop({
                checked: !1,
                disabled: !0
            }), $("#shoppingCartPay").addClass("button-style-square-disabled")) : ($("#checkall").prop("checked", !0), 0 != $("#product-list section").length && ($("#product-list :checkbox").prop("checked", !1), $("#product-list :checkbox[data-state=0][data-type!=20]").prop("checked", !0), $("#product-list :checkbox[data-state=0][data-type=20]").each(function (t, e) {
                $(e).parents(".productList").hasClass("disabled") ? $(e).prop("checked", !1) : $(e).prop("checked", !0)
            })))
        },
        getInvalidCauseReasonDesc: function (t, e, a) {
            var c = 4 == e || 20 == e ? "，点击删除" : "";
            return 6 == t ? "此商品暂时缺货" + c : 5 == t ? "此商品暂不可购买" + c : 7 == t ? "限购" + a + "件" + c : 2 == t || 3 == t || 4 == t ? "此商品已失效" + c : 0 == t ? "" : "此商品暂不可购买" + c
        },


        swiperInit: function () {
            var t = $(".sc-pro-roll .swiper-container"), e = [];
            t.each(function (t, a) {
                $(this).attr("id", "roll" + t), e.push($(this).attr("id"))
            }), $.each(e, function (t, e) {
                new Swiper("#" + e, {
                    pagination: ".swiper-pagination",
                    slidesPerView: 3.5,
                    paginationClickable: !0,
                    freeMode: !0,
                    watchSlidesProgress: !0
                })
            })
        },
        delPrdNum: function (t) {
            var e = "#quantity-" + t, a = parseInt($(e).val(), 10), c = "#minus-" + t, r = $(e).data("limit"),
                i = "#add-" + t, n = r > 0 ? r : 999;
            if (a <= 1)return $(c).removeClass("minus-disabled").addClass("minus-disabled"), !1;
            $(c).removeClass("minus-disabled"), 2 == a && $(c).removeClass("minus-disabled").addClass("minus-disabled"), a == n && $(i).removeClass("add-disabled"), $(e).val(--a)
        },
        addPrdNum: function (t, e) {
            var a = "#quantity-" + t, c = parseInt($(a).val(), 10), r = "#add-" + t, i = "#minus-" + t,
                n = e > 0 ? e : 999;
            if (c >= n)return $(r).removeClass("add-disabled").addClass("add-disabled"), $("#check-number").text("哎哟，购买数达上限啦").show().fadeOut(3e3), !1;
            1 == c && $(i).removeClass("minus-disabled"), c == n - 1 && $(r).addClass("add-disabled"), $(a).val(++c)
        },
        showServiceBox: function (t, e, a, c, r) {
            if ("true" == c && "true" != r)return !1;
            cartObj.isUpdateUI = "true" == r, cartObj.selectedServerSbomCode = t, cartObj.selectedExtData = {}, cartObj.selectedAccData = {}, new ecWap.ajax({
                url: pmsDomain + "/product/queryExtend.json?mainSbomCode=" + t + "&_t=" + (new Date).getTime(),
                dataType: "JSONP",
                timeout: 1e4,
                timeoutFunction: function () {
                    return ecWap.alert("请求超时！"), !1
                },
                successFunction: function (t) {
                    if (!t.success)return ecWap.alert(t.msg), !1;
                    var c = null != t.data && null != t.data.extendList && null != t.data.extendList[0] ? t.data.extendList[0].extendsSbomList : null;
                    cartObj.updateServiceBox(c, e, a), cartObj.serviceDialog.slideshow();
                    var r = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="ext-"]').attr("data-extid"),
                        i = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="acc-"]').attr("data-accid");
                    r && cartObj.serviceDialog.getBox().find("#ext-" + r).trigger("click"), i && cartObj.serviceDialog.getBox().find("#acc-" + i).trigger("click")
                }
            })
        },
        updateServiceBox: function (t, e, a) {
            var c = [], i = [];
            if (null != t && t.length > 0)for (var n = 0, d = t.length; n < d; n++) {
                var o = t[n];
                null != o && null != o.salePortalList && (o.mainSbomId = a, 1 == o.serviceType ? c.push(o) : 6 == o.serviceType && i.push(o))
            }
            var s = '<div class="insurance-cont">';
            (!r.default.isEmpty(c) || r.default.isEmpty(c) && r.default.isEmpty(i)) && (s += cartObj.renderServieView(0, c, e)), (!r.default.isEmpty(i) || r.default.isEmpty(c) && r.default.isEmpty(i)) && (s += cartObj.renderServieView(1, i, e)), s += "</div>", cartObj.serviceDialog = new ecWap.slideBox(s, {
                id: "serviceMainBox",
                className: "ecWap-box-em ecWap-box-lower",
                ishtml: !0,
                title: "选择保障服务",
                height: .6 * $(window).height(),
                position: "bottom",
                ok_txt: "确认",
                onok: function (t) {
                    if (t.close(), cartObj.isUpdateUI) {
                        if (!cartObj.oldSelectedServerData.hasOwnProperty(a)) {
                            var e = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="ext-"]').attr("data-extid"),
                                c = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="acc-"]').attr("data-accid"),
                                i = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="ext-"]').attr("data-prdid"),
                                n = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="acc-"]').attr("data-prdid");
                            cartObj.oldSelectedServerData[a] = {
                                "ext-id": e,
                                "acc-id": c,
                                "ext-prdid": i,
                                "acc-prdid": n
                            }
                        }
                        cartObj.editSelectedServerData[a] = {
                            ext: cartObj.selectedExtData,
                            acc: cartObj.selectedAccData
                        };
                        var d = cartObj.selectedExtData, o = cartObj.selectedAccData, s = "";
                        if (d && d.skuId && 3 != d.operation) {
                            var u = d.skuId;
                            s += '<div class="pro-service showService-' + cartObj.selectedServerSbomCode + '">', s += '<div class="pro-service-box">', s += '<p class="p-guarantee ext-' + u + '" data-extid="' + u + '" data-mainskuid="' + d.mainSkuId + '"  data-type="' + d.productType + '" >', s += "<span>" + ecWap.encodeScript(cartObj.selectedServerShowData[u].skuName) + '</span><span class="red">' + cartObj.selectedServerShowData[u].salePrice + "</span></p>", s += "</div></div>"
                        }
                        if (o && o.skuId && 3 != o.operation) {
                            var u = o.skuId;
                            s += '<div class="pro-service showService-' + cartObj.selectedServerSbomCode + '">', s += '<div class="pro-service-box"><p class="p-guarantee acc-' + u + '" data-accid="' + u + '" data-mainskuid="' + o.mainSkuId + '"  data-type="' + o.productType + '" >', s += "<span>" + ecWap.encodeScript(cartObj.selectedServerShowData[u].skuName) + '</span><span class="red">' + cartObj.selectedServerShowData[u].salePrice + "</span></p>", s += "</div></div>"
                        }
                        if (-1 == s.indexOf("p-guarantee") && (s += '<div class="pro-service showService-' + cartObj.selectedServerSbomCode + '">', s += '<div class="pro-service-box">', s += '<p class="p-guarantee"><span>可选保障服务</span></p>', s += "</div></div>"), s.indexOf("p-guarantee") > -1 && (s += '<div class="icon-more-right"></div>'), 0 == $("#showServiceId-" + cartObj.selectedServerSbomCode).length) {
                            var p = $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode + ">.serviceEvent").attr("onclick");
                            $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode).addClass("serviceEvent"), $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode).attr("onclick", p), $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode).empty(), $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode).html(s)
                        } else $("#showServiceId-" + cartObj.selectedServerSbomCode).empty(), $("#disabledShowServiceId-" + cartObj.selectedServerSbomCode).hide(), $("#showServiceId-" + cartObj.selectedServerSbomCode).html(s)
                    } else {
                        var e = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="ext-"]').attr("data-extid"),
                            c = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="acc-"]').attr("data-accid"),
                            l = cartObj.getServiceUpdateData(a, e, c);
                        null != l && l.length > 0 && (cartObj.update(l, function (t) {
                            r.default.refresh(t)
                        }), cartObj.toDataBI())
                    }
                }
            })
        },
        getServiceUpdateDataMap: function (t) {
            if (!cartObj.oldSelectedServerData.hasOwnProperty(t))return [];
            var e = cartObj.oldSelectedServerData[t], a = e["ext-id"], c = e["acc-id"],
                i = cartObj.editSelectedServerData[t], n = i.ext, d = i.acc, o = [];
            return r.default.isEmpty(a) && r.default.isEmpty(n.skuId) || a == n.skuId || (!r.default.isEmpty(a) && r.default.isEmpty(n.skuId) ? (n.operation = 3, n.quantity = 0, n.productType = 6, n.mainSkuId = t, n.skuId = a, n.oldDisPrdId = e["ext-prdid"], o.push(n)) : (n.operation = 1, o.push(n))), r.default.isEmpty(c) && r.default.isEmpty(d.skuId) || c == d.skuId || (!r.default.isEmpty(c) && r.default.isEmpty(d.skuId) ? (d.operation = 3, d.quantity = 0, d.productType = 7, d.mainSkuId = t, d.skuId = c, d.oldDisPrdId = e["acc-prdid"], o.push(d)) : (d.operation = 1, o.push(d))), o
        },
        getServiceUpdateData: function (t, e, a) {
            var c = [];
            return r.default.isEmpty(e) && r.default.isEmpty(cartObj.selectedExtData.skuId) || e == cartObj.selectedExtData.skuId || (!r.default.isEmpty(e) && r.default.isEmpty(cartObj.selectedExtData.skuId) ? (cartObj.selectedExtData.operation = 3, cartObj.selectedExtData.quantity = 0, cartObj.selectedExtData.productType = 6, cartObj.selectedExtData.mainSkuId = t, cartObj.selectedExtData.skuId = e, c.push(cartObj.selectedExtData)) : (cartObj.selectedExtData.operation = 1, c.push(cartObj.selectedExtData))), r.default.isEmpty(a) && r.default.isEmpty(cartObj.selectedAccData.skuId) || a == cartObj.selectedAccData.skuId || (!r.default.isEmpty(a) && r.default.isEmpty(cartObj.selectedAccData.skuId) ? (cartObj.selectedAccData.operation = 3, cartObj.selectedAccData.quantity = 0, cartObj.selectedAccData.productType = 7, cartObj.selectedAccData.mainSkuId = t, cartObj.selectedAccData.skuId = a, c.push(cartObj.selectedAccData)) : (cartObj.selectedAccData.operation = 1, c.push(cartObj.selectedAccData))), c
        },
        renderServieView: function (t, e, a) {
            var c = 0 == t, i = c ? "延保" : "碎屏保", n = c ? "sdetailCssExt" : "sdetailCssExtAcc",
                d = c ? "extWarrantyDetail" : "accWarrantyDetail",
                o = '<dl class="clearfix pchoice-insurance"><dt><label>' + i + "</label></dt><dd>";
            o += c ? '<a href="javascript:;" class="j_extunselect warrantyProduct selected" onclick="cartObj.extUnSelect();"><span>无需延保</span></a>' : '<a href="javascript:;" class="j_accunselect warrantyProduct selected" onclick="cartObj.accUnSelect();"><span>无需碎屏保</span></a>';
            for (var s = 0, u = e.length; s < u; s++) {
                var p = e[s];
                o += c ? '<a href="javascript:;" class="j_extwarrantyitem warrantyProduct" id="ext-' + p.sbomId + '" onclick="cartObj.warrantySelect(6,' + p.disPrdId + "," + p.sbomId + "," + p.mainSbomId + "," + a + "," + p.disPrdId + ',this);" >' : '<a href="javascript:;" class="j_accwarrantyitem warrantyProduct" id="acc-' + p.sbomId + '" onclick="cartObj.warrantySelect(7,' + p.disPrdId + "," + p.sbomId + "," + p.mainSbomId + "," + a + "," + p.disPrdId + ',this);" >', o += '<span id="price-' + p.sbomId + '">¥' + r.default.formatPrice(p.price) + '</span><span id="sbomName-' + p.sbomId + '">' + ecWap.encodeScript(p.sbomName) + "</span></a>"
            }
            return o += "</dd>", o += '<div class="clearfix ' + n + ' hide"><a href="javascript:;" id="' + d + '" class="disabled ">详情 &gt;</a></div>', o += "</dl>"
        },
        warrantySelect: function (t, e, a, c, r, i, n) {
            if (!$(n).hasClass("selected")) {
                $(n).parent().find("a").removeClass("selected"), $(n).addClass("selected");
                var d = {skuId: a, quantity: r, productType: t, mainSkuId: c, disPrdId: i};
                "6" == t ? ($(".sdetailCssExt").show(), $("#extWarrantyDetail").removeClass("disabled"), $("#extWarrantyDetail").attr("href", "/product/" + e + ".html#" + a), cartObj.selectedExtData = d) : ($(".sdetailCssExtAcc").show(), $("#accWarrantyDetail").removeClass("disabled"), $("#accWarrantyDetail").attr("href", "/product/" + e + ".html#" + a), cartObj.selectedAccData = d), cartObj.selectedServerShowData[a] = {
                    skuName: $("#sbomName-" + a).text(),
                    salePrice: $("#price-" + a).text()
                }
            }
        },
        extUnSelect: function () {
            var t = $(".j_extunselect");
            t.hasClass("selected") || ($(".j_extwarrantyitem").removeClass("selected"), t.addClass("selected"), cartObj.selectedExtData = {}, $(".sdetailCssExt").hide(), $("#extWarrantyDetail").addClass("disabled"), $("#extWarrantyDetail").attr("href", "javascript:;"))
        },
        accUnSelect: function () {
            var t = $(".j_accunselect");
            t.hasClass("selected") || ($(".j_accwarrantyitem").removeClass("selected"), t.addClass("selected"), cartObj.selectedAccData = {}, $(".sdetailCssExtAcc").hide(), $("#accWarrantyDetail").addClass("disabled"), $("#accWarrantyDetail").attr("href", "javascript:;"))
        },
        add: function (t, e, a) {
            console.log('add==========');
            if (e) {
                if ($(e).data("skuid") && $(e).data("mainskuid"))var c = "2", i = new r.default.cartItemObj({
                    itemId: $(e).data("skuid"),
                    itemType: "20",
                    qty: 1,
                    mainItemid: $(e).data("mainskuid")
                }); else var c = "5",
                    i = new r.default.cartItemObj({itemId: $(e).data("skuid"), itemType: "S0", qty: 1});
                if ($(e).data("prdid")) {
                    var n = ecWap.account.userId ? ecWap.account.userId : "";
                    _paq.push(["trackLink", "1#" + c + "_" + $(e).data("prdid") + "#" + n + "#", "link", ""])
                }
                i = [i], r.default.add(t, i, function (t) {
                    r.default.refresh(t)
                })
            }
        },
        update: function (t, e) {
            r.default.update(t, function (t) {
                r.default.isFunction(e) && e(t)
            })
        },
        del: function (t) {
            var e = "0#", a = $(t).attr("data-prdid");
            "6" == $(t).attr("producttype") || "7" == $(t).attr("producttype") ? e += "3" : "20" == $(t).attr("producttype") ? e += "2" : e += "4", e += "_" + a + "#" + (ecWap.account.userId ? ecWap.account.userId : "") + "#", _paq.push(["trackLink", e, "link", ""]);
            var c = new r.default.cartItemObj;
            switch ($(t).attr("producttype")) {
                case i.prdType.PRODUCT:
                    c.itemType = i.PrdItemType.PRODUCT;
                    break;
                case i.prdType.BUNDLER:
                    c.itemType = i.PrdItemType.BUNDLER;
                    break;
                case i.prdType.EXTEND:
                    c.itemType = i.PrdItemType.EXTEND;
                    break;
                case i.prdType.ACCIDENT:
                    c.itemType = i.PrdItemType.ACCIDENT;
                    break;
                case i.prdType.SALE:
                    c.itemType = i.PrdItemType.SALE
            }
            if ($(t).hasClass("giftcss")) {
                var n = [];
                $(".gift-" + $(t).attr("data-mainskuid")).each(function (e, a) {
                    $(a).attr("data-giftid") != $(t).attr("data-skuid") && n.push({sbomCode: $(a).attr("data-giftid")})
                }), c.skuId = $(t).attr("data-mainskuid"), c.productType = "1", c.quantity = 0, c.giftList = n, c.operation = 2, r.default.update([c], function (t) {
                    r.default.refresh(t)
                })
            } else c.itemId = $(t).attr("data-skuid"), c.mainItemid = $(t).attr("data-mainskuid"), r.default.del([c], function (t) {
                r.default.refresh(t)
            })
        },
        merge: function () {
            r.default.isEmpty(Utils.cookie.get("cartId")) || r.default.isEmpty(Utils.cookie.get("uid")) || r.default.merge(function () {
                window.location.reload()
            })
        },
        getCarPrdNum: function () {
            r.default.getCarPrdNum(function (t) {
                t > 99 ? $("#cartNum").html("99+").parent("em").addClass("show") : t > 0 && t <= 99 ? $("#cartNum").html(t).parent("em").addClass("show") : $("#cartNum").parent("em").removeClass("show")
            })
        },
        checkboxClick: function (t) {
            $("#checkall").prop("checked", !0), $(t).parents(".productList").find(".preferType :checkbox").prop("checked", $(t).prop("checked")), $("#product-list :checkbox[data-state=0]").each(function (t, e) {
                if (!$(e).prop("checked") && !$(e).parents(".productList").hasClass("disabled"))return $("#checkall").prop("checked", !1), !1
            }), cartObj.countPrice(), cartObj.buildForConfirm()
        },
        checkboxClickForUpdate: function (t) {
            $("#checkall").prop("checked", !0), $(t).parents(".productList").find(".preferType :checkbox").prop("checked", $(t).prop("checked")), $("#product-list :checkbox").each(function (t, e) {
                if (!$(e).prop("checked"))return $("#checkall").prop("checked", !1), !1
            })
        },
        checkallClick: function () {
            $("#checkall").prop("checked") ? 0 != $("#product-list section").length && ($("#product-list :checkbox[data-state=0][data-type!=20]").prop("checked", !0), $("#product-list :checkbox[data-type=20]").each(function (t, e) {
                    $(e).parents(".productList").hasClass("disabled") ? $(e).prop("checked", !1) : $(e).prop("checked", !0)
                })) : 0 != $("#product-list section").length && $("#product-list :checkbox").prop("checked", !1), cartObj.countPrice(), cartObj.buildForConfirm()
        },
        checkallClickForUpdate: function () {
            $("#checkall").prop("checked") ? 0 != $("#product-list").length && $("#product-list :checkbox").prop("checked", !0) : 0 != $("#product-list").length && $("#product-list :checkbox").prop("checked", !1)
        },
        countPrice: function () {
            var t = [];
            $(".productList :checkbox:checked[data-state=0][data-type!=20]").each(function (e, a) {
                var c = $(".ext-" + $(a).attr("data-skuid")).attr("data-extid"),
                    r = $(".acc-" + $(a).attr("data-skuid")).attr("data-accid"), i = [], n = [];
                if ($(".sale-" + $(a).attr("data-skuid")).each(function (t, e) {
                        n.push($(e).attr("data-saleid"))
                    }), i = i.join("-"), n = n.join(","), t.push({
                        skuId: $(a).attr("data-skuid"),
                        productType: "1",
                        quantity: $("#p-amount-num_" + $(a).attr("data-skuid") + " :input").val(),
                        giftids: i
                    }), c && "" != c)for (var d = c.split(","), e = 0; e < d.length; e++)t.push({
                    skuId: d[e],
                    mainSkuId: $(a).attr("data-skuid"),
                    productType: "6",
                    quantity: $("#p-amount-num_" + $(a).attr("data-skuid") + " :input").val()
                });
                if (r && "" != r)for (var o = r.split(","), e = 0; e < o.length; e++)t.push({
                    skuId: o[e],
                    mainSkuId: $(a).attr("data-skuid"),
                    productType: "7",
                    quantity: $("#p-amount-num_" + $(a).attr("data-skuid") + " :input").val()
                });
                if (n && "" != n)for (var s = n.split(","), e = 0; e < s.length; e++)t.push({
                    skuId: s[e],
                    mainSkuId: $(a).attr("data-skuid"),
                    productType: "20",
                    quantity: $("#p-amount-num_" + $(a).attr("data-skuid") + " :input").val()
                })
            }), $(".bundleList :checkbox:checked[data-state=0]").each(function (e, a) {
                t.push({
                    bundleId: $(a).data("bundleid"),
                    productType: "2",
                    quantity: $("#p-amount-num_" + $(a).attr("data-bundleid") + " :input").val()
                })
            }), t.length > 0 ? r.default.index(t, function (t) {
                t.cartInfo && t.cartInfo.cartVO ? ($("#total_price").html("&yen;&nbsp" + t.cartInfo.cartVO.miniTotalPrice.toFixed(2)), $("#shoppingCartPay span:first").html("结算(" + (t.cartInfo.cartVO.miniTotalNumber > 99 ? "99+" : t.cartInfo.cartVO.miniTotalNumber) + ")"), $("#shoppingCartPay").removeClass("button-style-square-disabled")) : ($("#total_price").html("&yen;&nbsp" + t.cartInfo.cartVO.miniTotalPrice.toFixed(2)), $("#shoppingCartPay span:first").html("结算(0)"), $("#shoppingCartPay").addClass("button-style-square-disabled"))
            }) : ($("#total_price").html("&yen;&nbsp;" + (0).toFixed(2)), $("#shoppingCartPay span:first").html("结算(0)"), $("#shoppingCartPay").addClass("button-style-square-disabled"))
        },
        checkCart: function () {
            var t = "/shoppingCart";
            return t = encodeURIComponent(encodeURIComponent(t)), ecWap.account.id ? "1" != ecWap.account.mobileStatus && 1 == ecWap.account.isBindMobile ? (window.location.href = "/account/toBindMobile?url=" + t, !1) : void cartObj.submit() : (cartObj.isFromWechat ? location.href = "/thirdparty/wechat/vcode/ad?url=/shoppingCart" : location.href = "/account/applogin?url=" + t, !1)
        },
        checkBind: function () {
            var t = $(".productList :checkbox:checked[data-state=0][data-type!=20]").length,
                e = $(".bundleList :checkbox:checked[data-state=0]").length;
            if (0 == t && 0 == e)return ecWap.toast("您还没有选择商品哟"), !1;
            if (ecWap.account.id) {
                var a = "";
                if (null != ecWap.account.bindedPhoneStatus && "force" == ecWap.account.bindedPhoneStatus)return a = "为了您的账户安全，华为商城强烈建议您进行手机帐号的绑定，绑定后，邮箱帐号和手机帐号都可以作为您的登录账户；若不绑定，只能进行浏览操作，不能购买。", ecWap.box(a, {
                    id: "agreement",
                    isconfirm: !0
                }), $("#ecWap-box-agreement .box-cancel").html("不绑定").attr("onclick", "cartObj.hiddenButtonShopCart();ecWap.box.close();"), $("#ecWap-box-agreement .box-ok").html("去绑定").attr("onclick", "cartObj.redirectBindingPage();"), !1;
                if (null != ecWap.account.bindedPhoneStatus && "easy" == ecWap.account.bindedPhoneStatus)return a = "为了您的账户安全，华为商城强烈建议您进行手机帐号的绑定，绑定后，邮箱帐号和手机帐号都可以作为您的登录账户；若不绑定，", null != bindDateCart && "" != bindDateCart && (a += "自" + bindDateCart + "起，"), a += "只能进行浏览操作，不能购买。", ecWap.box(a, {
                    id: "agreement",
                    isconfirm: !0
                }), $("#ecWap-box-agreement .box-cancel").html("不绑定").attr("onclick", "cartObj.checkCart();"), $("#ecWap-box-agreement .box-ok").html("去绑定").attr("onclick", "cartObj.redirectBindingPage();"), !1
            }
            cartObj.checkCart()
        },
        hiddenButtonShopCart: function () {
            $("#shoppingCartPay").addClass("button-style-square-disabled"), $("#shoppingCartPay").removeAttr("onclick").off("click")
        },
        redirectBindingPage: function () {
            var t = "/shoppingCart";
            t = encodeURIComponent(encodeURIComponent(t)), window.location.href = "/shoppingCart/bindingPhoneNum?url=" + t
        },
        submit: function () {
            $("#orderForm").submit()
        },
        showCartUpdate: function () {
            $("#product-list").removeClass("sc-pro-edit").addClass("sc-pro-edit"), $("#showUl").hide(), $(".showPriceUI").hide(), $(".disabledcss").hide(), $("#comb-list").hide(), $(".p-amount").hide(), $(".sc-roll-area").hide(), $(".osc-total-price").hide(), $(".serviceEvent").each(function (t, e) {
                $(e).attr("onclick") && $(e).attr("onclick", $(e).attr("onclick").replace(")", ",'true')"))
            }), $(".invalid").removeClass("invalid"), $(".disabled").removeClass("disabled"), $(":checkbox:disabled").prop("disabled", !1), $(".low-stocks").removeClass("low-stocks"), $("#editUl").show(), $(".p-amount-num").show(), $(":checkbox").prop("checked", !1), $(":checkbox").attr("onclick", "cartObj.checkboxClickForUpdate();"), $("#checkall").attr("onclick", "cartObj.checkallClickForUpdate();"), $("#checkall :checkbox").removeAttr("onclick"), $("#shoppingCartPay span:first").html("删除"), $("#shoppingCartPay").attr("onclick", "cartObj.cartDelete();").removeClass("button-style-square-disabled"), $(".prddetail").attr("href", "javascript:void(0);"), $("#checkall").prop("disabled", !1)
        },
        cartUpdate: function () {
            if (cartObj.deleteItems)var t = cartObj.deleteItems; else var t = [];
            var e = [];
            $(".productList:visible :checkbox[data-type!=20]").each(function (a, c) {
                var i = [], n = [], d = $("#p-amount-num_" + $(c).attr("data-skuid") + " :input"),
                    o = parseInt(d.val(), 10) - parseInt(d.data("quantity"), 10), s = [];
                $(".gift-" + $(c).attr("data-skuid")).each(function (t, e) {
                    i.push($(e).attr("data-giftid"))
                }), $(".sale-" + $(c).attr("data-skuid")).each(function (t, e) {
                    $(e).parents(".preferType:visible").length > 0 && n.push($(e).attr("data-saleid"))
                }), n = n.join(",");
                for (var a = 0; a < i.length; a++) {
                    var u = {};
                    u.sbomCode = i[a], s.push(u)
                }
                t.push({skuId: $(c).attr("data-skuid"), productType: "1", quantity: o, giftList: s, operation: 2});
                var p = cartObj.getServiceUpdateDataMap($(c).attr("data-skuid"));
                if (p && p.length > 0)for (var a = 0; a < p.length; a++)r.default.isEmpty(p[a].operation) || (t.push(p[a]), e.push(p[a]));
                if (n && "" != n)for (var l = n.split(","), a = 0; a < l.length; a++)t.push({
                    skuId: l[a],
                    mainSkuId: $(c).attr("data-skuid"),
                    productType: "20",
                    quantity: 0,
                    operation: 2
                })
            }), $(".bundleList:visible :checkbox").each(function (e, a) {
                var c = $("#p-amount-num_" + $(a).attr("data-bundleid") + " :input");
                t.push({
                    bundleId: $(a).data("bundleid"),
                    productType: "2",
                    quantity: parseInt(c.val(), 10) - parseInt(c.data("quantity"), 10),
                    operation: 2
                })
            }), cartObj.delPrdDataBI(e), r.default.update(t, function (t) {
                r.default.refresh(t)
            })
        },
        cartDelete: function () {
            $(":checkbox:checked[id!=checkall]").length < 1 ? ecWap.toast("请选择至少一件商品") : ecWap.confirmDialog("确认要删除勾选商品吗？", function (t) {
                t.close(), $(":checkbox:checked[id!=checkall][data-type!=20]").parents(".productList").hide(), $(":checkbox:checked[id!=checkall]").parents(".bundleList").hide();
                var e = [], a = "";
                a = cartObj.BIValue && "" != cartObj.BIValue ? cartObj.BIValue : "0#", $(":checkbox:checked[id!=checkall][data-type!=20]").each(function (t, c) {
                    0 == t && -1 == a.indexOf("_") || (a += ":");
                    var i = $(c).data("prdid");
                    if ("2" == $(c).data("type")) {
                        a += "0_" + $(c).data("bundleid");
                        var n = {bundleId: $(c).data("bundleid"), productType: "2", operation: 3}
                    } else if ("1" == $(c).data("type")) {
                        a += "1_" + i;
                        var n = {skuId: $(c).data("skuid"), productType: "1", operation: 3};
                        $(".gift-" + $(c).data("skuid")).each(function (t, e) {
                            -1 != a.indexOf("_") && (a += ":"), a += "4_" + $(e).attr("data-prdid")
                        });
                        var d = cartObj.oldSelectedServerData[$(c).attr("data-skuid")];
                        if (r.default.isEmpty(d)) {
                            var o = $(".ext-" + $(c).attr("data-skuid")).attr("data-prdid"),
                                s = $(".acc-" + $(c).attr("data-skuid")).attr("data-prdid");
                            a = cartObj.extServiceBi(o, s, a)
                        } else {
                            var o = d["ext-prdid"], s = d["acc-prdid"];
                            a = cartObj.extServiceBi(o, s, a)
                        }
                        $(".sale-" + $(c).data("skuid")).each(function (t, e) {
                            -1 != a.indexOf("_") && (a += ":"), a += "2_" + $(e).attr("data-prdid")
                        })
                    }
                    e.push(n)
                }), $(":checkbox:checked[id!=checkall][data-type=20]").each(function (t, c) {
                    0 == t && -1 == a.indexOf("_") || (a += ":");
                    var r = $(c).data("prdid");
                    a += "2_" + r, $(c).parents(".preferType").hide();
                    var i = {
                        skuId: $(c).data("saleid"),
                        mainSkuId: $(c).data("mainskuid"),
                        productType: "20",
                        operation: 3
                    };
                    e.push(i)
                }), cartObj.BIValue = a, cartObj.deleteItems ? cartObj.deleteItems = cartObj.deleteItems.concat(e) : cartObj.deleteItems = e, $(":checkbox:checked[id!=checkall]").prop("checked", !1)
            })
        },
        extServiceBi: function (t, e, a) {
            var c = a;
            return t && "" != t && (-1 != c.indexOf("_") && (c += ":"), c += "3_" + t), e && "" != e && (-1 != c.indexOf("_") && (c += ":"), c += "3_" + e), c
        },
        buildForConfirm: function () {
            if (0 == $(":checkbox:checked").length) $("#skuIdAndQtys").attr("value", ""), $("#mainSkuIds").attr("value", ""), $("#types").attr("value", ""), $("#bundleIdAndQtys").attr("value", ""), $("#giftSkuIds").attr("value", ""); else {
                var t = [], e = [], a = [], c = [], r = [];
                $(".productList :checkbox:checked[data-type!=20][data-state=0]").each(function (e, i) {
                    var n = $(".ext-" + $(i).attr("data-skuid")).attr("data-extid"),
                        d = $(".acc-" + $(i).attr("data-skuid")).attr("data-accid"), o = [], s = [];
                    if ($(".gift-" + $(i).attr("data-skuid")).each(function (t, e) {
                            o.push($(e).attr("data-giftid"))
                        }), $(".sale-" + $(i).attr("data-skuid")).each(function (t, e) {
                            s.push($(e).attr("data-saleid"))
                        }), o = o.join("-"), r.push(o), s = s.join(","), t.push($(i).attr("data-skuid") + ":" + $("#p-amount-num_" + $(i).attr("data-skuid") + " :input").val()), a.push(""), c.push("0"), n && "" != n)for (var u = n.split(","), e = 0; e < u.length; e++)t.push(u[e] + ":" + $("#p-amount-num_" + $(i).attr("data-skuid") + " :input").val()), a.push($(i).attr("data-skuid")), c.push("1"), r.push("");
                    if (d && "" != d)for (var p = d.split(","), e = 0; e < p.length; e++)t.push(p[e] + ":" + $("#p-amount-num_" + $(i).attr("data-skuid") + " :input").val()), a.push($(i).attr("data-skuid")), c.push("6"), r.push("");
                    if (s && "" != s)for (var l = s.split(","), e = 0; e < l.length; e++)t.push(l[e] + ":1"), a.push($(i).attr("data-skuid")), c.push("20"), r.push("")
                }), $(".bundleList :checkbox:checked[data-state=0]").each(function (t, a) {
                    e.push($(a).attr("data-bundleid") + ":" + $("#p-amount-num_" + $(a).attr("data-bundleid") + " :input").val())
                }), $("#skuIdAndQtys").attr("value", t.join(",")), $("#mainSkuIds").attr("value", a.join(",")), $("#types").attr("value", c.join(",")), $("#bundleIdAndQtys").attr("value", e.join(",")), $("#giftSkuIds").attr("value", r.join(","))
            }
        },


        getRecommend: function () {
            ecWap.ajax({
                url: "/shoppingCart/queryRecommand.json",
                dataType: "JSON",
                timeout: 2e3,
                errorFunction: function () {
                },
                successFunction: function (t) {
                    if (t.success) {
                        for (var e = 0, a = "", c = 0, r = t.recommandPrdList.length; c < r; c++) {
                            e % 2 == 0 && (a += "<ul>");
                            var i = t.recommandPrdList[c];
                            a += '<li><a href="/product/' + i.disPrdId + ".html#" + i.skuId + '"><p class="p-img"><img src=' + mediaPath + i.photoPath + "428_428_" + i.photoName + '></p><p class="p-name"><span><em>' + ecWap.encodeScript(i.displayName) + '</em></span></p><p class="p-price"><b>¥&nbsp;' + i.unitPrice + "</b>", i.unitPrice != i.orderPrice && (a += "&nbsp;<del>¥&nbsp;" + i.orderPrice + "</del>"), a += "</p></a></li>", e % 2 == 1 && (a += "</ul>"), e += 1
                        }
                        $("#recommandHeader").show(), $("#recommandDIV").html(a)
                    }
                }
            })
        },


        //加入购物车
        addProductToCart: function (t, e) {
            console.log('addProductToCart---event');
            console.log(t);
            if (!r.default.isEmpty(t)) {
                var a = 0;
                $.each(t, function (t, e) {

                    a += e.quantity
                    console.log(a);
                }), cartObj.isCanAddCart(a, function (f) {

                    console.log(a);
                    console.log(f);
                    console.log('isCanAddCart---------------');
                    a ? new ecWap.ajax({
                        url: "goods.php?act=isCanAddCart",
                        type: "GET",
                        data: r.default.queryData(t),
                        timeout: 1e4,
                        timeoutFunction: function () {
                            return !1
                        },
                        successFunction: function (et) {
                            console.log(et);
                            if (!et.success)return ecWap.alert(et.msg), !1;

                            r.default.add("productDetail", t, e)
                        }
                    }) : ecWap.alert("购物车商品数量超过限制！")
                })
            }
        },

        //isCanAddCart
        isCanAddCart: function (t, e) {
            console.log('判断是否可以加入购物车--isCanAddCart');
            console.log(r.default.isEmpty(t));

            r.default.isEmpty(t) ? e(!0) : r.default.getCarPrdNum(function (a) {
                console.log(cartMaxNum);
                e(t + a <= cartMaxNum ? !0 : !1)
            })
        },


        showCoupons: function (t) {
            cartObj.updateCoupons(t), cartObj.couponDialog.slideshow()
        },
        updateCoupons: function (t) {
            if (t && t.length > 0) {
                for (var e = '<div class="coupons-cont"><ul>', a = 0, c = t.length; a < c; a++) {
                    var r = t[a], i = "button-vip-benefit-get j_getCouponBtn", n = "立即领取", d = "",
                        o = "<span>&yen </span><em>" + r.amount + "</em> 优惠券";
                    switch ("" + r.state) {

                        case"-1":
                            i = "button-vip-benefit-had", n = "已领完";
                            break;
                        case"1":
                            i = "button-vip-benefit-get j_getCouponBtn", n = "立即领取";
                            break;
                        case"2":
                            i = "button-vip-benefit-had", n = "已领取";
                            break;
                        case"3":
                            i = "button-vip-benefit-begin", n = "即将开始";
                            break;
                        case"4":
                            i = "button-vip-benefit-disabled", n = "已结束";
                            break;
                        default:
                            i = "button-vip-benefit-get j_getCouponBtn", n = "立即领取"
                    }
                    2 == r.type && (d = "coupons-discount", o = "<em>" + r.discount + "</em><span>折</span> 优惠券"), 3 == r.type && (d = "coupons-noPostage", o = "免邮券"), e += '<li><div class="coupons-item ' + d + '"><div class="coupons-box"><p class="p-name">' + o + '</p><p class="p-desc"><span>' + r.batchName + '</span></p><p class="p-date"><span>有效期：' + r.beginDate + " - " + r.endDate + '</span></p><p class="p-button"><a href="javascript:;" class="' + i + '" batchCode="' + r.batchCode + '"itemIndex="' + a + '"activityCode="' + r.activityCode + '"><span>' + n + "</span></a></p></div></div></li>"
                }
                e += "</ul></div>", cartObj.couponDialog = new ecWap.slideBox(e, {
                    id: "couponMainBox",
                    className: "ecWap-box-em ecWap-box-lower",
                    ishtml: !0,
                    title: "领券",
                    height: .6 * $(window).height(),
                    position: "bottom",
                    ok_txt: "完成",
                    onok: function (t) {
                        t.close()
                    }
                }), cartObj.couponDialog.getBox().find(".j_getCouponBtn").on("click", function () {
                    cartObj.couponAction.clickConponIndex = $(this).attr("itemIndex"), cartObj.couponAction.forbidRepeatClick(!0, cartObj.couponDialog.getBox().find(".j_getCouponBtn")), cartObj.couponAction.getCoupon($(this), $(this).attr("activityCode"), $(this).attr("batchCode"))
                })
            }
        },
        couponAction: {
            Domain: {WAP: wapDomain, AMS: amsDomain},
            Url: {
                LOGIN: "/account/applogin?url=",
                BIND_PHONE: "/shoppingCart/bindingPhoneNum?url=",
                AUTHENTICATE: "/auth/index?c_url=",
                PICK_COUPON: "/couponCodeActivity/receive.json"
            },
            promptInfo: {
                coupnMsg: {
                    9200: "被你的热情吓到了，容我缓缓",
                    9201: "被你的热情吓到了，容我缓缓",
                    9202: "被你的热情吓到了，容我缓缓",
                    9203: "被你的热情吓到了，容我缓缓",
                    9204: "别着急，活动还没开始呦",
                    9205: "来晚了，活动结束啦",
                    9206: "",
                    9207: "亲，您的等级不满足活动条件哦",
                    9208: "亲，绑定手机后才能领取哦",
                    9209: "亲，实名认证后才能领取哦",
                    9210: "亲，需完善资料才能领取哦",
                    9211: "亲，此优惠券是新人专享哦",
                    9212: "亲，您已领过啦",
                    9213: "亲，您暂不符合领取优惠券的签到要求哦",
                    9214: "亲，优惠券已领完啦",
                    9215: "亲，您的签到值不足",
                    9216: "亲，您的积分不足",
                    9217: "粉丝太热情，此优惠券被领完了噢",
                    9218: "亲，还没到领取时间哟",
                    other: "被你的热情吓到了，容我缓缓"
                }
            },
            isEmpty: function (t) {
                return "undefined" == t || null == t || "" == t || 0 == t.length
            },
            buildQueryStr: function (t) {
                var e = {};
                return cartObj.couponAction.isEmpty(t) ? e : (cartObj.couponAction.isEmpty(t.activityCode) || (e.activityCode = t.activityCode), cartObj.couponAction.isEmpty(t.batchCode) || (e.batchCode = t.batchCode), cartObj.couponAction.isEmpty(t.batchCode) || (e.receiveChannel = t.receiveChannel), e)
            },
            getJSON: function (t) {
                if (cartObj.couponAction.isEmpty(t) || cartObj.couponAction.isEmpty(t.url))return null;
                var e = cartObj.couponAction.Domain.AMS + t.url + "?t=" + (new Date).getTime() + "&";
                $.ajax({
                    url: e, dataType: "JSONP", data: t.data, timeout: 1e4, error: function (t, e) {
                        return cartObj.couponAction.forbidRepeatClick(!1), ecWap.box("被你的热情吓到了，容我缓缓", {
                            id: "couponBox",
                            width: 80
                        }), !1
                    }, success: function (e) {
                        cartObj.couponAction.forbidRepeatClick(!1), t.callback(e, t)
                    }
                })
            },
            getCoupon: function (t, e, a) {
                var c = {};
                c.url = cartObj.couponAction.Url.PICK_COUPON, c.activityCode = e, c.batchCode = a, c.receiveChannel = 2, c.callback = cartObj.couponAction.getCouponCallback, c.data = cartObj.couponAction.buildQueryStr(c), c.jqobj = t, cartObj.couponAction.getJSON(c)
            },
            getCouponCallback: function (t, e) {
                var a = "", c = e.jqobj;
                if (t && t.success) {
                    if (a = null != t.wapReviceSuccTip && "" != t.wapReviceSuccTip ? t.wapReviceSuccTip : "领取优惠券成功", "1" != t.state)switch ("" + t.state) {
                        case"-1":
                            c.attr("class", "button-vip-benefit-had"), c.find("span").text("已领完");
                            break;
                        case"2":
                            c.attr("class", "button-vip-benefit-had"), c.find("span").text("已领取");
                            break;
                        case"3":
                            c.attr("class", "button-vip-benefit-begin"), c.find("span").text("即将开始");
                            break;
                        case"4":
                            c.attr("class", "button-vip-benefit-disabled"), c.find("span").text("已结束")
                    }
                } else {
                    if (a = t.msg, "9208" == t.code)return ecWap.box(a, {
                        ishtml: !1,
                        showTitle: !0,
                        className: "ecWap-box",
                        isconfirm: !0,
                        ok_txt: "去绑定",
                        oncanel: function (t) {
                            t.close()
                        },
                        onok: function () {
                            window.location = cartObj.couponAction.Domain.WAP + cartObj.couponAction.Url.BIND_PHONE + encodeURIComponent(encodeURIComponent("/shoppingCart"))
                        }
                    }), !1;
                    if ("9209" == t.code)return ecWap.box(a, {
                        ishtml: !1,
                        showTitle: !0,
                        className: "ecWap-box",
                        isconfirm: !0,
                        ok_txt: "去认证",
                        oncanel: function (t) {
                            t.close()
                        },
                        onok: function () {
                            window.location = cartObj.couponAction.Domain.WAP + cartObj.couponAction.Url.AUTHENTICATE + cartObj.couponAction.Domain.WAP + encodeURIComponent("/shoppingCart")
                        }
                    }), !1;
                    if ("9206" == t.code)return window.location = cartObj.couponAction.Domain.WAP + cartObj.couponAction.Url.LOGIN + encodeURIComponent(encodeURIComponent("/shoppingCart")), !1;
                    if ("1" != t.state) {
                        switch ("" + t.state) {
                            case"-1":
                                c.attr("class", "button-vip-benefit-had"), c.find("span").text("已领完");
                                break;
                            case"2":
                                c.attr("class", "button-vip-benefit-had"), c.find("span").text("已领取");
                                break;
                            case"3":
                                c.attr("class", "button-vip-benefit-begin"), c.find("span").text("即将开始");
                                break;
                            case"4":
                                c.attr("class", "button-vip-benefit-disabled"), c.find("span").text("已结束")
                        }
                        c.off("click")
                    }
                    cartObj.couponAction.clickConponIndex && (couponDataList[cartObj.couponAction.clickConponIndex].state = t.state), cartObj.couponAction.clickConponIndex = null
                }
                ecWap.box(a, {id: "couponBox", width: 80})
            },
            getErrorInfo: function (t, e) {
                var a = cartObj.couponAction.promptInfo[t];
                return e && a.hasOwnProperty(e.code) ? a[e.code] : a.other
            },
            forbidRepeatClick: function (t, e) {
                if (t) {
                    var a = e.parents(".coupons-cont"), c = a.height(), r = a.width(), i = "";
                    a.css("position", "relative"), i += '<div id="clickMask" style="height:' + c + "px;width:" + r + 'px;position:absolute;z-index:1000;top:0;left:0;"></div>', a.append(i)
                } else $("#clickMask").remove()
            }
        },
        toDataBI: function () {
            var t = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="ext-"]').attr("data-prdid"),
                e = $(".showService-" + cartObj.selectedServerSbomCode).find('p[class*="acc-"]').attr("data-prdid"),
                a = "", c = ecWap.account.userId ? ecWap.account.userId : "",
                r = 3 == cartObj.selectedExtData.operation ? "0" : "1",
                i = 3 == cartObj.selectedAccData.operation ? "0" : "1",
                n = "0" == r ? t : cartObj.selectedExtData.disPrdId,
                d = "0" == i ? e : cartObj.selectedAccData.disPrdId;
            cartObj.selectedExtData.operation && cartObj.selectedExtData.operation == cartObj.selectedAccData.operation ? (a = r + "#3_" + n + ":3_" + d, _paq.push(["trackLink", a + "#" + c + "#", "link", ""])) : (cartObj.selectedExtData.operation && (a = r + "#3_" + n, _paq.push(["trackLink", a + "#" + c + "#", "link", ""])), cartObj.selectedAccData.operation && (a = i + "#3_" + d, _paq.push(["trackLink", a + "#" + c + "#", "link", ""])))
        },
        delPrdDataBI: function (t) {
            var e = [], a = [];
            if (null != t && t.length > 0)for (var c = 0; c < t.length; c++) {
                var r = t[c];
                null != r && (3 == r.operation ? e.push(r.oldDisPrdId) : 1 == r.operation && a.push(r.disPrdId))
            }
            var i = "" != cartObj.BIValue ? cartObj.BIValue : "0#",
                n = ecWap.account.userId ? ecWap.account.userId : "";
            if (e && "" != e)for (var c = 0; c < e.length; c++)-1 != i.indexOf("_") && (i += ":"), i += "3_" + e[c];
            if (-1 != i.indexOf("_") && _paq.push(["trackLink", i + "#" + n + "#", "link", ""]), a && "" != a) {
                for (var d = "1#", c = 0; c < a.length; c++)-1 != d.indexOf("_") && (d += ":"), d += "3_" + a[c];
                -1 != d.indexOf("_") && _paq.push(["trackLink", d + "#" + n + "#", "link", ""])
            }
        }
    }
}]);